---
description: Standards for API endpoints following CRUD principles
globs: src/app/api/**/*.js
alwaysApply: false
---
# API Endpoints CRUD Standards

All API endpoints should follow REST and CRUD standards. Each model in the system should have corresponding endpoints for standard operations.

## Required HTTP Methods

For each model, implement these standard methods:

| Method | Purpose | Status Codes |
| :----- | :------ | :----------- |
| GET    | Retrieve resource(s) | 200 (OK), 404 (Not Found) |
| POST   | Create new resource | 201 (Created), 400 (Bad Request) |
| PUT/PATCH | Update existing resource | 200 (OK), 404 (Not Found) |
| DELETE | Remove resource | 204 (No Content), 404 (Not Found) |

## Implementation Requirements

1. **Documentation**: All endpoint functions must include JSDoc comments that detail:
   - Function purpose
   - Request parameters
   - Response format
   - Possible errors
   - Example usage (when complex)

2. **Error Handling**: Implement consistent error responses with appropriate status codes

3. **Validation**: Validate all input parameters before processing

## Example Implementation

```javascript
/**
 * Creates a new user in the database.
 * @param {Object} request - The request object
 * @param {Object} request.body - The request body
 * @param {string} request.body.email - The user's email address (required)
 * @param {string} [request.body.username] - The user's username (optional)
 * @param {string} [request.body.firstName] - The user's first name (optional)
 * @param {string} [request.body.lastName] - The user's last name (optional)
 * @returns {Promise<Object>} The created user object
 * @throws {Error} If email is missing or database operation fails
 */
export async function POST(request) {
  try {
    // Authentication check
    await checkSession(await auth0.getSession());

    // Parse request body
    const data = await request.json();

    // Validate required fields
    if (!data.email) {
      return NextResponse.json({ error: 'Email is required' }, { status: 400 });
    }

    // Process the request
    const user = {
      email: data.email,
      username: data.username,
      firstName: data.firstName,
      lastName: data.lastName
    };

    // Create resource
    const newUser = await prisma.user.create({
      data: user
    });

    // Return successful response with 201 Created status
    return NextResponse.json({ user: newUser }, { status: 201 });
  } catch (error) {
    console.error('Error creating user:', error);
    return NextResponse.json(
      { error: 'Internal Server Error' },
      { status: 500 }
    );
  }
}
```

## Status Code Guidelines

- **200 OK**: Successful GET, PUT, or PATCH
- **201 Created**: Successful POST that created a resource
- **204 No Content**: Successful DELETE
- **400 Bad Request**: Invalid input parameters
- **401 Unauthorized**: Authentication required
- **403 Forbidden**: Authenticated but not authorized
- **404 Not Found**: Resource not found
- **500 Internal Server Error**: Server-side error

## Best Practices

1. Keep endpoints focused on a single responsibility
2. Use consistent naming conventions (plural nouns for collections)
3. Implement pagination for endpoints returning multiple items
4. Include proper authentication and authorization checks
5. Return appropriate HTTP status codes and error messages